
DOCUMENTA√á√ÉO DO PROJETO DE AUTOMA√á√ÉO - ACESSO E-FISCO COM CERTIFICADO DIGITAL
------------------------------------------------------------------------------

üóìÔ∏è Data de gera√ß√£o: 07/04/2025 20:37:03

üîπ OBJETIVO DO PROJETO:
Automatizar o processo de login no portal do e-Fisco de Pernambuco utilizando certificado digital do tipo .pfx, acessar a √°rea de "Consulta e Download de NFe" e realizar uma consulta autom√°tica de notas fiscais, resolvendo o reCAPTCHA via integra√ß√£o com a API AntiCaptcha.

------------------------------------------------------------------------------

üîπ FLUXO DO SCRIPT ATUALMENTE:

1. **Instala√ß√£o do Certificado Digital**
   - O certificado √© fornecido pelo usu√°rio no formato `.pfx` e instalado automaticamente no reposit√≥rio de certificados do Windows (`CurrentUser\My`) utilizando PowerShell.

2. **Acesso ao Portal e-Fisco**
   - O script acessa a URL: `https://efisco.sefaz.pe.gov.br/sfi_com_sca/PRMontarMenuAcesso`.
   - Clica automaticamente no bot√£o "Certificado Digital".
   - Usa `pyautogui` para pressionar `Enter` e confirmar o certificado instalado.

3. **Navega√ß√£o at√© Consulta de NFe**
   - Utiliza o campo de busca principal da aplica√ß√£o para pesquisar "Consulta e Download de NFe (#)".
   - Clica no resultado da busca.
   - Abre nova aba com a p√°gina espec√≠fica da consulta.

4. **Preenchimento dos Filtros de Consulta**
   - Data Inicial: `01/01/2025`
   - Data Final: `01/01/2025`
   - Tipo de contribuinte: `Emitente`
   - IE Emitente: `056680422`

5. **Resolu√ß√£o Autom√°tica do reCAPTCHA**
   - O script captura a `sitekey` presente na p√°gina.
   - Envia a chave para a API do AntiCaptcha.
   - Ao receber o token, injeta no campo oculto `g-recaptcha-response` da p√°gina.
   - Ap√≥s isso, o bot√£o "Consultar" √© clicado automaticamente.

------------------------------------------------------------------------------

üîπ FERRAMENTAS E TECNOLOGIAS UTILIZADAS:

- `Selenium`: automa√ß√£o do navegador.
- `pyautogui`: controle do teclado para interagir com o seletor de certificado.
- `AntiCaptcha (anticaptchaofficial)`: resolu√ß√£o autom√°tica de reCAPTCHA v2.
- `Tkinter`: sele√ß√£o e senha do certificado (fase inicial do projeto).
- `PowerShell`: instala√ß√£o silenciosa do certificado.
- `WebDriverManager`: gerenciamento autom√°tico do driver do Chrome.

------------------------------------------------------------------------------

üîπ FUNCIONALIDADES FUTURAS SUGERIDAS:

- Automatizar o preenchimento de campos adicionais (CNPJ, s√©rie, etc.).
- Baixar e organizar os arquivos XML ou PDF das notas retornadas.
- Exportar os dados para planilhas Excel.
- Adicionar interface visual (GUI).
- Reutilizar o script para m√∫ltiplas empresas com agendamento autom√°tico.

------------------------------------------------------------------------------

üîπ OBSERVA√á√ÉO:

O script atualmente √© compat√≠vel com Windows (por conta da instala√ß√£o do certificado via PowerShell) e depende que o Chrome esteja instalado. A automa√ß√£o √© sens√≠vel ao tempo de carregamento da p√°gina e √† exist√™ncia de apenas um certificado instalado.

